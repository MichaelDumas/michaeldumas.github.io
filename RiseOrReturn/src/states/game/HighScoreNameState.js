import State from"../../../lib/State.js";import HighScoreTracker from"../../../lib/HighScoreTracker.js";import GameStateName from"../../enums/GameStateName.js";import ImageName from"../../enums/ImageName.js";import SoundName from"../../enums/SoundName.js";import{CANVAS_HEIGHT,CANVAS_WIDTH,context,images,keys,sounds,stateMachine,timer}from"../../globals.js";export default class HighScoreNameState extends State{constructor(){super(),this.chars=[65,65,65],this.highlightedChar=0}enter(t){this.level=t.level,this.highlightedChar=0}update(t){if(keys.Enter){keys.Enter=!1;const t=String.fromCharCode(this.chars[0])+String.fromCharCode(this.chars[1])+String.fromCharCode(this.chars[2]);HighScoreTracker.addHighScore(t,this.level),sounds.play(SoundName.Select),stateMachine.change(GameStateName.Transition,{fromState:this,toState:stateMachine.states[GameStateName.TitleScreen]})}keys.a&&this.highlightedChar>0?(keys.a=!1,this.highlightedChar=this.highlightedChar-1,sounds.play(SoundName.Change)):keys.d&&this.highlightedChar<2&&(keys.d=!1,this.highlightedChar=this.highlightedChar+1,sounds.play(SoundName.Change)),keys.w?(keys.w=!1,this.chars[this.highlightedChar]=this.chars[this.highlightedChar]+1,this.chars[this.highlightedChar]>90&&(this.chars[this.highlightedChar]=65)):keys.s&&(keys.s=!1,this.chars[this.highlightedChar]=this.chars[this.highlightedChar]-1,this.chars[this.highlightedChar]<65&&(this.chars[this.highlightedChar]=90))}render(){images.render(ImageName.Background,0,0,CANVAS_WIDTH,CANVAS_HEIGHT),context.save(),context.fillStyle="white",context.font="20px Joystix",context.textAlign="center",context.fillText(`Your high score: ${this.level}`,.5*CANVAS_WIDTH,.15*CANVAS_HEIGHT),context.font="15px Joystix",context.fillText("W/S to choose a letter",.5*CANVAS_WIDTH,.3*CANVAS_HEIGHT),context.fillText("A/D to change slot",.5*CANVAS_WIDTH,.4*CANVAS_HEIGHT),context.font="50px Joystix",context.fillStyle=0===this.highlightedChar?"cornflowerblue":"white",context.fillText(`${String.fromCharCode(this.chars[0])}`,.4*CANVAS_WIDTH,.7*CANVAS_HEIGHT),context.fillStyle=1===this.highlightedChar?"cornflowerblue":"white",context.fillText(`${String.fromCharCode(this.chars[1])}`,.5*CANVAS_WIDTH,.7*CANVAS_HEIGHT),context.fillStyle=2===this.highlightedChar?"cornflowerblue":"white",context.fillText(`${String.fromCharCode(this.chars[2])}`,.6*CANVAS_WIDTH,.7*CANVAS_HEIGHT),context.fillStyle="white",context.font="10px Joystix",context.textBaseline="middle",context.textAlign="center",context.fillText("Press Enter to confirm!",.5*CANVAS_WIDTH,.9*CANVAS_HEIGHT),context.restore()}}