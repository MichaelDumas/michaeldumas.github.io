var spawn=require("child_process").spawn,path=require("path"),fs=require("fs");function installArchSpecificPackage(e,n){process.env.npm_config_global="false";var s="win32"==process.platform?"win":process.platform,r="win"==s&&"ia32"==process.arch?"x86":process.arch;spawn("win"==s?"npm.cmd":"npm",["install","--no-save",["node",s,r].join("-")+"@"+e],{stdio:"inherit",shell:!0}).on("close",(function(e){var i=n.resolve(["node",s,r].join("-")+"/package.json"),c=JSON.parse(fs.readFileSync(i,"utf8")).bin.node,o=path.resolve(path.dirname(i),c);try{fs.mkdirSync(path.resolve(process.cwd(),"bin"))}catch(e){if("EEXIST"!=e.code)throw e}if(linkSync(o,path.resolve(process.cwd(),c)),"win"==s){var a=JSON.parse(fs.readFileSync(path.resolve(process.cwd(),"package.json")));fs.writeFileSync(path.resolve(process.cwd(),"bin/node"),"This file intentionally left blank"),a.bin.node="bin/node.exe",fs.writeFileSync(path.resolve(process.cwd(),"package.json"),JSON.stringify(a,null,2))}return process.exit(e)}))}function linkSync(e,n){try{fs.unlinkSync(n)}catch(e){if("ENOENT"!=e.code)throw e}return fs.linkSync(e,n)}module.exports=installArchSpecificPackage;