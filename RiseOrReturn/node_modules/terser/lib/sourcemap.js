"use strict";import MOZ_SourceMap from"source-map";import{defaults}from"./utils/index.js";async function SourceMap(o){var e;o=defaults(o,{file:null,root:null,orig:null,orig_line_diff:0,dest_line_diff:0});var r=new MOZ_SourceMap.SourceMapGenerator({file:o.file,sourceRoot:o.root});return o.orig&&(e=await new MOZ_SourceMap.SourceMapConsumer(o.orig)).sources.forEach((function(o){var n=e.sourceContentFor(o,!0);n&&r.setSourceContent(o,n)})),{add:function(n,i,t,u,c,l){if(e){var a=e.originalPositionFor({line:u,column:c});if(null===a.source)return;n=a.source,u=a.line,c=a.column,l=a.name||l}r.addMapping({generated:{line:i+o.dest_line_diff,column:t},original:{line:u+o.orig_line_diff,column:c},source:n,name:l})},get:function(){return r},toString:function(){return r.toString()},destroy:function(){e&&e.destroy&&e.destroy()}}}export{SourceMap};